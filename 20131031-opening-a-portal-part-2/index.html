<!DOCTYPE html>
<html>
<head>
	<title>Open a Portal and Communicate With The Other Side... (Part 2)</title>
	<script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js?skin=doxy"
			type="text/javascript"></script>
	<link type="text/css" rel="stylesheet" href="../common/blog.css">
	<style type="text/css">
		/** Custom blog styles 2013-12-01 GHA **/
		@import url(http://fonts.googleapis.com/css?family=Source+Code+Pro:300,400,700|Open+Sans:700,300,400);

		/**************************************************************************
		** DF Blog Styles
		**************************************************************************/

		.df-blog > * {
			font-family: "Open Sans", Arial, "Lucida Grande", sans-serif;
		}

		.df-blog a:hover {
			text-decoration: underline;
		}

		.df-blog blockquote {
			border:             1px solid burlywood;
			border-right-width: 4px;
			border-left-width:  4px;
			font-size:          14px;
			width:              80%;
			-moz-box-shadow:    0 0 10px rgba(51, 51, 51, 0.5);
			-webkit-box-shadow: 0 0 10px rgba(51, 51, 51, 0.5);
			box-shadow:         0 0 10px rgba(51, 51, 51, 0.5);
			font-family:        "Open Sans", "Helvetica Neue Light", 'Arial', sans-serif;
		}

		.df-blog h1, .df-blog h2, .df-blog h3, .df-blog h4, .df-blog h5 {
			font-family: "Open Sans", Arial, "Lucida Grande", sans-serif;
		}

		.df-blog p, .df-blog h2, .df-blog h3, .df-blog h4, .df-blog ul, .df-blog ul li, .df-blog pre, .df-blog ol, .df-blog li {
			margin-left:  25px;
			margin-right: 25px;
		}

		.df-blog h4, .df-blog h5, .df-blog section h4 + p, .df-blog section h5 + p {
			margin-left:  50px;
			margin-right: 50px;
		}

		.df-blog pre.prettyprint {
			padding:            20px;
			-moz-box-shadow:    6px 8px 10px rgba(51, 51, 51, 0.25);
			-webkit-box-shadow: 6px 8px 10px rgba(51, 51, 51, 0.25);
			box-shadow:         6px 8px 10px rgba(51, 51, 51, 0.25);
			margin:             25px;
			font-family:        "Source Code Pro", "Consolas", "Monaco", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace;
			font-weight:        normal;
			font-size:          13px;
			border-radius:      4px;
		}

		.df-blog pre.prettyprint ol {
			/*padding-right: 8px;*/
		}

		.df-blog pre.prettyprint ol li:first-child {
			/*padding-top: 8px;*/
		}

		.df-blog pre.prettyprint ol li:last-child {
			/*padding-bottom: 8px;*/
		}

		.df-blog ol.linenums {
			/*font-size: 12px;*/
		}

		.df-blog h1.title {
			text-align:     center;
			border-bottom:  1px solid #ddd;
			margin:         auto 25px 30px;
			text-shadow:    -1px -1px #ccc;
			letter-spacing: -1.5px;
		}

		.df-blog h2, .df-blog h3, .df-blog h4, .df-blog h5 {
			border-bottom: 1px solid #eee;
			text-shadow:   -1px -1px #ccc;
		}

		.df-blog ul, .df-blog ol {
			list-style: square;
		}

		.df-blog ol.steps {
			list-style: decimal;
		}

		.post-body .df-blog > img.picture, .df-blog > img.picture, .df-blog img.picture {
			float:              left !important;
			-moz-box-shadow:    6px 8px 10px rgba(51, 51, 51, 0.25);
			-webkit-box-shadow: 6px 8px 10px rgba(51, 51, 51, 0.25);
			box-shadow:         6px 8px 10px rgba(51, 51, 51, 0.25);
			-webkit-transform:  rotate(356deg);
			-moz-transform:     rotate(356deg);
			-o-transform:       rotate(356deg);
			width:              250px !important;
			height:             250px !important;
			border:             5px solid white;
			margin:             15px 35px 35px 15px !important;
			max-width:          250px !important;
		}

		.df-blog figure {
		}

		.df-blog figure img {
			-moz-box-shadow:    6px 8px 10px rgba(51, 51, 51, 0.25);
			-webkit-box-shadow: 6px 8px 10px rgba(51, 51, 51, 0.25);
			box-shadow:         6px 8px 10px rgba(51, 51, 51, 0.25);
			border:             1px solid rgba(0, 0, 0, .25);
			margin:             5px auto 5px !important;
			float:              none !important;
			width:              auto !important;
			height:             auto !important;
			max-width:          100% !important;
		}

		.blog-listing-wrapper .post-listing .post-item .post-body .df-blog div.inset img, .df-blog div.inset img {
			vertical-align: text-bottom;
			height:         200px !important;
			box-shadow:     0 0 10px #aaa;
			display:        inline-block;
			/*margin-top:     15px !important;*/
			max-width:      100% !important;
		}

		.blog-listing-wrapper .post-listing .post-item .post-body .df-blog figure img.shrink, .df-blog figure img.shrink {
			width: 80% !important;
		}

		.df-blog figcaption {
			font-size:   80%;
			font-weight: bold;
		}

		.df-blog code {
			font-size:        12px;
			border:           1px dotted #e0e0e0;
			background-color: #efefef;
			padding:          2px 3px;
			line-height:      inherit;
			vertical-align:   middle;
			display:          inline-block;
			font-weight:      bold;
		}

		.df-blog section {
			margin-left: 25px;
		}

		.df-blog section h2 {
			margin-left: 25px;
		}

		.df-blog section.flush-left {
			margin-left: 5px;
		}

		.df-blog .fatal {
			color:       darkred;
			font-weight: 700;
		}

		.df-blog blockquote .title {
			font-size:      18px;
			font-weight:    bold;
			text-shadow:    none;
			border-bottom:  1px solid antiquewhite;
			padding-top:    8px;
			padding-bottom: 0;
			margin-left:    24px;
			margin-right:   25px;
			display:        block;
		}

		.df-blog blockquote > .title + p {
			margin-top: 8px;
		}

		.df-blog div.inset {
			float:       right;
			padding:     10px 10px 6px;
			margin-left: 14px;
		}

		.df-blog blockquote.inset {
			padding:    10px 10px 6px;
			min-height: 250px;
			font-size:  16px;
		}
	</style>
</head>
<body>

<div class="hs-migrated-cms-post df-blog">
	<div class="pull-left">
		<img class="picture"
			 src="//raw.github.com/dreamfactorysoftware/dsp-blog-posts/master/20131031-opening-a-portal-part-1/portal.jpg">
	</div>

	<section id="introduction" class="flush-left">
		<H2>Are we there yet?</H2>

		<p style="margin-top:25px;">This post picks up where part 1 left off... I apologize for the delay. My original post was too long so I split it into two parts. In reviewing
			the second installment, I realized that the concepts would be better conveyed through an actual application.</p>

		<p>The application is called <strong>Portal Sandbox</strong> and the full source code is available on
			<a href="https://github.com/dreamfactorysoftware/portal-sandbox" target="_blank">GitHub</a>. Go ahead and clone a copy so you can follow along. I'll wait...</p>
	</section>

	<section id="recap" class="flush-left">
		<H2>First Installment Recap & Checklist</H2>

		<p>So in <a target="_blank" href="http://blog.dreamfactory.com/blog/bid/341114/OAuth-Tutorial-Part-One">Using OAuth with the New Portal Service</a>, I introduced the
			concept of the portal.
			To recap, the new <strong>Portal</strong>
			service provides access to authenticated services and API on a per-user basis. The portal service requires that you create <strong>Providers</strong>, or endpoints and
			keys for a particular service. For the purposes of this blog, I chose Facebook's
			<a href="https://developers.facebook.com/docs/graph-api/" target="_blank">Graph API</a>
			as the example provider.</p>

		<p>When a user authenticates with a <strong>provider</strong>, the returned access credentials (an OAuth token in the case of Facebook) are encrypted and stored in the
			<strong>ProviderUser</strong> resource. These are accessible via the DSP's REST API using the <code>/rest/system/provider</code> and
			<code>/rest/system/provider_user</code> endpoints respectively.
			<code>provider</code>.</p>

		<h4>Key Concepts from Part One:</h4>

		<ul>
			<li>The new <strong>Portal</strong> service provides your DSP with access to authenticated services and APIs on a per-user basis.</li>
			<li>No providers are supplied with the DSP. You must create them yourself.</li>
			<li>No UI exists to maninpulate providers or provider users. This will be available in a future update (at the time of this writing the current version is
				<a href="https://github.com/dreamfactorysoftware/dsp-core" target="_blank">1.2.3</a>
				).
			</li>
		</ul>

		<h4>Checklist:</h4>

		<ul>
			<li>The new <strong>Portal</strong> service provides your DSP with access to authenticated services and APIs on a per-user basis.</li>
			<li>No providers are supplied with the DSP. You must create them yourself.</li>
			<li>No UI exists to maninpulate providers or provider users. This will be available in a future update (at the time of this writing the current version is
				<a href="https://github.com/dreamfactorysoftware/dsp-core" target="_blank">1.2.3</a>
				).
			</li>
		</ul>
	</section>

	<section id="portal-sandbox">
		<H2>Enter Sandbox (We're off to never never-land)</H2>

		<p>The flow here is as follows. Calling the Portal API relays your remote API request out to the appropriate provider. If there are no credentials stored for the user
			requesting the resource, most sites present a login dialog to authenticate the user making the request. The Facebook authentication dialog is show in figure 7.</p>
		<figure>
			<img src="figure7.png">
			<figcaption>Figure 7: Authenticate and Authorize</figcaption>
		</figure>
		<p>Once you answer "Ok"/"Continue" to one of these login dialogs, the provider redirects back to the configured URL (this varies per service) with a
			<strong>code</strong>. This code is then exchanged for an actual
			<strong>access token</strong> which is used for all subsequent communication to the API on the authenticating users' behalf.</p>

		<p>The token and any other provider-specific information is then stored along with the user's ID and the ID of the provider in your DSP's local database. This information
			is in
			the
			<strong>provider user</strong> resource/table.</p>
	</section>
</body>
</html>
